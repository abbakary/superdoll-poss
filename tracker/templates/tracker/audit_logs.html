{% extends 'tracker/base.html' %} {% load static %} {% load date_filters %} {% block title %}Audit Logs{% endblock %} {% block content %} <div class="container-fluid"> <div class="page-title"> <div class="row"> <div class="col-6"><h4>Audit Logs</h4></div> <div class="col-6"> <ol class="breadcrumb"> <li class="breadcrumb-item"><a href="{% url 'tracker:dashboard' %}">Home</a></li> <li class="breadcrumb-item active">Audit Logs</li> </ol> </div> </div> </div> </div> <div class="container-fluid"> <div class="card mb-3"> <div class="card-body d-flex justify-content-between align-items-center flex-wrap gap-2"> <form method="get" class="d-flex flex-wrap gap-2 align-items-center m-0"> <div class="input-group" style="min-width: 300px;"> <input class="form-control" type="text" name="q" value="{{ q|default:'' }}" placeholder="Search in all fields..."> </div> <div class="input-group" style="min-width: 200px;"> <select class="form-select" name="action"> <option value="">All Actions</option> {% for action in all_actions %} <option value="{{ action }}" {% if action_filter == action %}selected{% endif %}>{{ action|title }}</option> {% endfor %} </select> </div> <div class="input-group" style="min-width: 200px;"> <select class="form-select" name="user"> <option value="">All Users</option> {% for user in all_users %} <option value="{{ user }}" {% if user_filter == user %}selected{% endif %}>{{ user }}</option> {% endfor %} </select> </div> <div class="d-flex gap-2"> <button class="btn btn-primary" type="submit"><i class="fa fa-filter me-1"></i>Apply Filters</button> {% if q or action_filter or user_filter %} <a class="btn btn-light" href="{% url 'tracker:audit_logs' %}"><i class="fa fa-times me-1"></i>Clear All</a> {% endif %} </div> </form> <div class="d-flex gap-2"> <a class="btn btn-outline-secondary" href="{% url 'tracker:users_list' %}"><i class="fa fa-users me-1"></i>User Management</a> <form method="post" class="m-0"> {% csrf_token %} <input type="hidden" name="action" value="clear" /> <button class="btn btn-outline-danger" type="submit"><i class="fa fa-trash me-1"></i>Clear Logs</button> </form> </div> </div> </div> <div class="card"> <div class="card-body p-0"> <div class="table-responsive"> <table id="auditTable" class="table mb-0"> <thead> <tr> <th>When</th> <th>User</th> <th>Action</th> <th>Details</th> <th>IP</th> <th></th> </tr> </thead> <tbody> {% for log in logs %} <tr> <td class="text-nowrap">{% firstof log.timestamp log.time '-' %}</td> <td class="text-nowrap">{% firstof log.user '-' %}</td> <td class="text-capitalize">{% firstof log.action '-' %}</td> <td>{% firstof log.description log.details '-' %}</td> <td class="text-nowrap">{% firstof log.ip '-' %}</td> <td class="text-end"> <div class="btn-group"> <a class="btn btn-sm btn-outline-primary" href="{% url 'tracker:audit_logs' %}?user={{ log.user|urlencode }}" title="Show all actions by this user"> <i class="fa fa-user me-1"></i>User </a> <a class="btn btn-sm btn-outline-secondary" href="{% url 'tracker:audit_logs' %}?action={{ log.action|urlencode }}" title="Show all {{ log.action }} actions"> <i class="fa fa-search me-1"></i>Action </a> </div> </td> </tr> {% empty %} <tr><td colspan="6" class="text-center p-4">No logs</td></tr> {% endfor %} </tbody> </table> </div> </div> </div> </div> {% endblock %} {% block extra_js %} <script src="{% static 'assets/js/datatable/datatables/jquery.dataTables.min.js' %}"></script> <script src="{% static 'assets/js/datatable/datatables/datatable.custom.js' %}"></script> <script> (function(){ var el = document.getElementById('auditTable'); if (el && $(el).DataTable) { $('#auditTable').DataTable({ pageLength: 25, order: [[0, 'desc']], columnDefs: [ { targets: 4, orderable: false } ] }); } })(); </script> {% endblock %} 
