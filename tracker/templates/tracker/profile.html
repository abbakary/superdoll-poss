{% extends 'tracker/base.html' %} {% load static %} {% load date_filters %} {% block title %}My Profile{% endblock %} {% block extra_css %} <style> .profile-picture-container { position: relative; width: 150px; height: 150px; margin: 0 auto 20px; border-radius: 50%; overflow: hidden; border: 3px solid #f8f9fa; box-shadow: 0 0 10px rgba(0,0,0,0.1); } .profile-picture { width: 100%; height: 100%; object-fit: cover; } .profile-picture-upload { position: absolute; bottom: 0; left: 0; right: 0; background: rgba(0,0,0,0.5); color: white; text-align: center; padding: 5px; cursor: pointer; font-size: 12px; transition: all 0.3s; } .profile-picture-upload:hover { background: rgba(0,0,0,0.7); } #id_photo { display: none; } .preview-container { text-align: center; margin-bottom: 20px; } .preview-image { max-width: 100%; max-height: 200px; margin-top: 10px; border-radius: 5px; display: none; } </style> {% endblock %} {% block content %} <div class="container-fluid"> <div class="page-title"> <div class="row"> <div class="col-6"><h4>My Profile</h4></div> <div class="col-6"> <ol class="breadcrumb"> <li class="breadcrumb-item"><a href="{% url 'tracker:dashboard' %}">Dashboard</a></li> <li class="breadcrumb-item active">My Profile</li> </ol> </div> </div> </div> <div class="row"> <div class="col-lg-4"> <div class="card"> <div class="card-body text-center"> <div class="profile-picture-container"> {% if user.profile.photo %} <img id="profileImage" src="{{ user.profile.photo.url }}" alt="Profile Photo" class="profile-picture"> {% else %} <img id="profileImage" src="{% static 'assets/images/dashboard/profile.png' %}" alt="Default Profile" class="profile-picture"> {% endif %} <label for="id_photo" class="profile-picture-upload"> <i class="fa fa-camera"></i> Change Photo </label> </div> <h4 class="mt-2">{{ user.get_full_name|default:user.username }}</h4> <p class="text-muted">{{ user.email }}</p> <p class="text-muted"> <small>Member since {{ user.date_joined|date:"F Y" }}</small> </p> </div> </div> </div> <div class="col-lg-8"> <div class="card"> <div class="card-header"> <h5 class="mb-0">Profile Information</h5> </div> <div class="card-body"> {% if messages %} {% for message in messages %} <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert"> {{ message }} <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button> </div> {% endfor %} {% endif %} <form method="post" enctype="multipart/form-data"> {% csrf_token %} <div class="row mb-3"> <div class="col-md-6"> <label for="{{ form.first_name.id_for_label }}" class="form-label">First Name</label> {{ form.first_name }} {% if form.first_name.errors %} <div class="invalid-feedback d-block"> {{ form.first_name.errors.0 }} </div> {% endif %} </div> <div class="col-md-6"> <label for="{{ form.last_name.id_for_label }}" class="form-label">Last Name</label> {{ form.last_name }} {% if form.last_name.errors %} <div class="invalid-feedback d-block"> {{ form.last_name.errors.0 }} </div> {% endif %} </div> </div> <div class="mb-3"> <label for="{{ form.photo.id_for_label }}" class="form-label">Profile Photo</label> <div class="input-group"> {{ form.photo }} {% if form.photo.errors %} <div class="invalid-feedback d-block"> {{ form.photo.errors.0 }} </div> {% endif %} </div> <div class="form-text">Max file size: 2MB. Allowed formats: JPG, PNG, GIF</div> <div class="preview-container"> <img id="imagePreview" src="#" alt="Image Preview" class="preview-image" /> </div> </div> <div class="d-flex justify-content-end"> <button type="submit" class="btn btn-primary"> <i class="fa fa-save me-2"></i>Save Changes </button> </div> </form> </div> </div> </div> </div> </div> {% endblock %} {% block extra_js %} <script> // Preview image before upload function previewImage(input) { const preview = document.getElementById('imagePreview'); const profileImage = document.getElementById('profileImage'); const file = input.files[0]; if (file) { const reader = new FileReader(); reader.onload = function(e) { preview.src = e.target.result; preview.style.display = 'block'; profileImage.src = e.target.result; } reader.readAsDataURL(file); } } // Initialize file input change event document.addEventListener('DOMContentLoaded', function() { const fileInput = document.getElementById('id_photo'); if (fileInput) { fileInput.addEventListener('change', function() { previewImage(this); }); } // Add Bootstrap validation classes const forms = document.querySelectorAll('form'); Array.from(forms).forEach(form => { form.addEventListener('submit', event => { if (!form.checkValidity()) { event.preventDefault(); event.stopPropagation(); } form.classList.add('was-validated'); }, false); }); }); </script> {% endblock %}
